"use strict";(()=>{var ge=Object.create;var D=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var ve=Object.getOwnPropertyNames,O=Object.getOwnPropertySymbols,fe=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var V=(e,t,r)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,b=(e,t)=>{for(var r in t||={})_.call(t,r)&&V(e,r,t[r]);if(O)for(var r of O(t))we.call(t,r)&&V(e,r,t[r]);return e};var ye=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var We=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ve(t))!_.call(e,o)&&o!==r&&D(e,o,{get:()=>t[o],enumerable:!(i=me(t,o))||i.enumerable});return e};var Ie=(e,t,r)=>(r=e!=null?ge(fe(e)):{},We(t||!e||!e.__esModule?D(r,"default",{value:e,enumerable:!0}):r,e));var de=ye((It,le)=>{"use strict";var S=Object.defineProperty,Ae=Object.defineProperties,Re=Object.getOwnPropertyDescriptor,xe=Object.getOwnPropertyDescriptors,be=Object.getOwnPropertyNames,C=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,B=(e,t,r)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||={})z.call(t,r)&&B(e,r,t[r]);if(C)for(var r of C(t))X.call(t,r)&&B(e,r,t[r]);return e},R=(e,t)=>Ae(e,xe(t)),Le=(e,t)=>{var r={};for(var i in e)z.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&C)for(var i of C(e))t.indexOf(i)<0&&X.call(e,i)&&(r[i]=e[i]);return r},Te=(e,t)=>{for(var r in t)S(e,r,{get:t[r],enumerable:!0})},Ce=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of be(t))!z.call(e,o)&&o!==r&&S(e,o,{get:()=>t[o],enumerable:!(i=Re(t,o))||i.enumerable});return e},Pe=e=>Ce(S({},"__esModule",{value:!0}),e),v=(e,t,r)=>new Promise((i,o)=>{var n=d=>{try{a(r.next(d))}catch(c){o(c)}},s=d=>{try{a(r.throw(d))}catch(c){o(c)}},a=d=>d.done?i(d.value):Promise.resolve(d.value).then(n,s);a((r=r.apply(e,t)).next())}),ee={};Te(ee,{createContextualWidget:()=>ft});le.exports=Pe(ee);var Se=e=>!!e.getInstance,Fe=e=>!!e.getDeviceId,te=e=>{var t,r,i,o,n,s,a,d,c,u,p;let h=null,m=null;if(!e.amplitude)return{userId:h,deviceId:m};if(Se(e.amplitude)){let g=(t=e.amplitude)==null?void 0:t.getInstance();h=(i=(r=g?.options)==null?void 0:r.userId)!=null?i:null,m=(n=(o=g?.options)==null?void 0:o.deviceId)!=null?n:null}return Fe(e.amplitude)&&(h=(d=(a=(s=e.amplitude)==null?void 0:s.getUserId)==null?void 0:a.call(s))!=null?d:null,m=(p=(u=(c=e.amplitude)==null?void 0:c.getDeviceId)==null?void 0:u.call(c))!=null?p:null),{userId:h,deviceId:m}},De=500,ze=5,L=null,Me=(e,t)=>{let{delay:r=De,times:i=ze}=t||{},o=0;return n=>{n.cohortUserId||(L&&e.removeEventListener("load",L),L=()=>{let s=setInterval(()=>{o+=1;let{userId:a}=te(e);if(a){n.identifyUser({cohortUserId:a}),clearInterval(s);return}o>=i&&clearInterval(s)},r)},e.addEventListener("load",L))}},Oe={apiKey:"",snippetCdnUrl:"https://snippet.maze.co",apiUrl:"https://prompts.maze.co/api",testingPagesUrl:"https://t.maze.co"},Ve=480,_e=e=>y(y({},Oe),e.mazeContextualSettings||{}),re=class{constructor(e){this.cacheClearTimeouts={},this.cachedItems=new Set,this.storage=e}getValue(e){let t=this.storage.getItem(e);if(!t)return null;let r=JSON.parse(t);return this.isValueExpired(r)?(this.removeValue(e),null):r.value}setValue(e,t,r=0){let i={value:t,expiresIn:r>0?Date.now()+r*60*1e3:0};this.storage.setItem(e,JSON.stringify(i)),this.cachedItems.add(e),this.cacheClearTimeouts[e]&&clearTimeout(this.cacheClearTimeouts[e]),r>0&&(this.cacheClearTimeouts[e]=setTimeout(()=>{this.removeValue(e)},r*60*1e3))}removeValue(e){this.storage.removeItem(e),this.cachedItems.delete(e),this.cacheClearTimeouts[e]&&(clearTimeout(this.cacheClearTimeouts[e]),delete this.cacheClearTimeouts[e])}clearAll(){this.cachedItems.forEach(e=>{this.removeValue(e)})}isValueExpired(e){return e.expiresIn>0&&e.expiresIn<Date.now()}},F=class{constructor(e=!1){this.supportsExipresIn=e,this.cacheClearTimeouts={},this.storage={}}getValue(e){return this.storage[e]||null}setValue(e,t,r=0){this.storage[e]=t,this.cacheClearTimeouts[e]&&clearTimeout(this.cacheClearTimeouts[e]),r>0&&this.supportsExipresIn&&(this.cacheClearTimeouts[e]=setTimeout(()=>{this.removeValue(e)},r*60*1e3))}removeValue(e){delete this.storage[e],this.cacheClearTimeouts[e]&&(clearTimeout(this.cacheClearTimeouts[e]),delete this.cacheClearTimeouts[e])}clearAll(){Object.keys(this.storage).forEach(e=>{this.removeValue(e)})}},$e="__contextual-widget__",He=({type:e,action:t,payload:r,channel:i})=>({type:e,action:t,payload:r,channel:i}),K=e=>`${$e}${e}`,je=(e,t={})=>{let{id:r="PROMPT"}=t,i=[];return{send:o=>{let n=He(y({channel:K(r)},o));e.postMessage(n,"*")},listen:o=>{let n=a=>{let{data:d}=a,c=d,{channel:u}=c,p=Le(c,["channel"]);u===K(r)&&o(p)};e.addEventListener("message",n);let s=()=>{e.removeEventListener("message",n)};i.push(s)},close:()=>{i.forEach(o=>{o()}),i=[]}}},ie=class extends Error{constructor(e){super(e),this.name="ScriptLoadError"}},Be=(e,t)=>{let r=e.location.href;return i=>{let o=t.body||t,{location:n}=e;function s(){n.href!==r&&(r=n.href,i(n.href))}let a=new MutationObserver(s);o&&a.observe(o,{subtree:!0,childList:!0})}},oe=e=>(t,r={})=>{let i=e.createElement("script");return i.src=t,i.async=r.async||!1,i.defer=r.defer||!1,i.id=r.id||"",e.getElementsByTagName("head")[0].appendChild(i),i},Ke="https://snippet.maze.co",Ne="maze-scaffold-helper-script",ke=(e,t,...r)=>v(void 0,[e,t,...r],function*(i,o,n={}){return new Promise((s,a)=>{let{snippetCdnUrl:d=Ke}=n,c=Ne;if(i.getElementById(c)){s(i.getElementById(c));return}let u=`${d}/contextualScaffoldHelpers.js`,p=oe(i)(u,{id:c,async:!0});p.addEventListener("load",s),p.addEventListener("error",()=>{a(new ie(`Error loading script ${u}`))})})}),qe="https://snippet.maze.co",Ge="maze-widget-app-script",Ze=(e,t,r={})=>{let{snippetCdnUrl:i=qe}=r,o=Ge;if(e.getElementById(o))return e.getElementById(o);let n=`${i}/contextualWidgetAppScaffold.js`;return oe(e)(n,{id:o,async:!0})},N={[0]:void 0,[1]:"color: cyan",[3]:void 0,[5]:"color: yellow",[9]:"color: red"};function Je(e){try{if(!(e!=null&&e.localStorage))return;let t=e.localStorage.getItem("maze-log-level");return t?parseInt(t,10):void 0}catch{return}}var P=class{static initializeLoggerMode(e){var t;e&&(P._window=e,e.MAZE_LOG_LEVEL=(t=Je(e))!=null?t:9)}getCurrentLogLevel(){var e,t;return(t=(e=P._window)==null?void 0:e.MAZE_LOG_LEVEL)!=null?t:9}verbose(e,t){this.logEvent(e,1,t)}info(e,t){this.logEvent(e,3,t)}warning(e,t){this.logEvent(e,5,t)}error(e,t){this.logEvent(e,9,t)}logEvent(e,t=3,r){let i=this.getCurrentLogLevel();t>=i&&(r===void 0?console.log(`%c maze-snippet: ${e}`,N[t]):console.log(`%c maze-snippet: ${e}`,N[t],r))}},l=new P,ne=class extends Error{constructor(e,t,r){super(e),this.statusCode=t,this.correlationId=r,this.name="WidgetLoadError"}};function Ye(e,t){return Math.random()*(t-e)+e}function Qe(){return`${Date.now()}-${Ye(0,1e4)}`}function Xe({apiUrl:e,apiKey:t}){return function(r,i,o){return v(this,null,function*(){let n=yield fetch(`${e}/${r}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","x-api-key":t,"x-maze-snippet-src":"contextual-widget","x-maze-correlation-id":o},body:JSON.stringify(i)});if(n.ok)return n;let s="Error fetching contextual prompts.";try{s=(yield n.json()).message||s}catch{}throw new ne(s,n.status,o)})}}var se=({apiUrl:e,apiKey:t})=>{var r;let i=Xe({apiUrl:e,apiKey:t}),o=typeof window<"u"?(r=window.navigator)==null?void 0:r.userAgent:"unknown",n=Qe();return{getWidgetsForVisitor:s=>v(void 0,[s],function*({cohortProvider:a,cohortUserId:d}){try{return yield(yield i("widgets",{cohortProvider:a,cohortUserId:d},n)).json()}catch(c){return l.error("Error fetching contextual prompts.",{error:c}),[]}}),logEvent:s=>v(void 0,[s],function*({source:a,level:d,message:c,data:u}){var p;try{yield i("event",{source:a,level:d,message:c,data:R(y({},u),{userAgent:o,pathname:((p=window?.location)==null?void 0:p.pathname)||""})},n)}catch(h){l.error("Error logging events to the API.",{error:h})}})}},et=typeof window<"u"&&window.localStorage?new re(window.localStorage):new F,k=new F,q=!1,G=e=>{if(q)return k.getValue(e)||[];try{return et.getValue(e)||[]}catch{return q=!0,l.warning("[getWidgetIdsFromKey] Failed to get widget key from cache. Using fallback."),k.getValue(e)||[]}},tt=()=>{let e=G("maze-contextual-widget-dismissed"),t=G("maze-contextual-widget-started");return[...e,...t]},rt={promptHostElement:{self:{default:2147483647},children:{contextualWidgetBranding:{self:{default:10}}}},mediaHostElement:{self:{hidden:0,shown:2147483647},children:{imageZoomControlButtons:{self:{default:10}}}}},it=(e,t)=>{var r,i,o,n;let s="maze-contextual-widget-fonts";if((i=(r=t.contentWindow)==null?void 0:r.document)!=null&&i.querySelector(`link#${s}`))return;let a=e.createElement("link");a.href="https://assets-cdn.maze.co/fonts/roobert-pro.css",a.rel="stylesheet",a.type="text/css",a.id=s,(n=(o=t?.contentWindow)==null?void 0:o.document)==null||n.head.appendChild(a)},T=e=>`${e}px`;function ot(e,{id:t}){return e.querySelector(`#${t}`)}function nt(e,{id:t,tag:r}){let i=ot(e,{id:t});if(i)return i;let o=e.createElement(r);return o.id=t,e.body.appendChild(o),o}var ae=({id:e,_document:t=document})=>t.querySelector(`#${e}`),st=(e,t,{id:r,className:i})=>{var o;let n=ae({_document:(o=t.contentWindow)==null?void 0:o.document,id:r});return n||(n=e.createElement("div"),n.id=r),n.classList.contains(i)||n.classList.add(i),n.style.cssText=`
    width: 100%;
    height: 100%;
    position:relative;
  `,n},at=(e,t)=>({id:r})=>{var i,o,n;let s=`${r}-host`,a=`${r}-container`,d=nt(t,{id:s,tag:"iframe"}),c=st(t,d,{id:a,className:a});return(n=(o=(i=d.contentWindow)==null?void 0:i.document)==null?void 0:o.body)==null||n.appendChild(c),d.addEventListener("load",()=>{var u,p,h,m;ae({_document:(u=d.contentWindow)==null?void 0:u.document,id:a})||(m=(h=(p=d.contentWindow)==null?void 0:p.document)==null?void 0:h.body)==null||m.appendChild(c)}),{host:d,container:c}},lt="maze-contextual-widget",Z=80,J={compact:{height:T(430),width:T(420+Z)},expanded:{height:T(680),width:T(420+Z)}},dt=`
  height: ${J.compact.height};
  width: ${J.compact.width};
  max-width: 100%;
  position: fixed;
  border: none;
  overflow: hidden;
  z-index: ${rt.promptHostElement.self.default};
  color-scheme: normal;
`,Y={BOTTOM_LEFT:{left:"0",bottom:"0",transform:"initial",right:"initial",top:"initial"},BOTTOM_RIGHT:{right:"0",bottom:"0",transform:"initial",left:"initial",top:"initial"},MIDDLE_LEFT:{left:"0",top:"50%",transform:"translateY(-50%)",right:" initial",bottom:"initial"},MIDDLE_RIGHT:{right:"0",top:"50%",transform:"translateY(-50%)",left:"initial",bottom:"initial"},CENTERED:{left:"50%",top:"50%",transform:"translate(-50%, -50%)",right:"initial",bottom:"initial"}},ct={left:"0",right:"0",bottom:"0",top:"initial",transform:"initial"},Q=e=>Object.entries(e).reduce((t,[r,i])=>`${t}${r}:${i};
`,""),ut=e=>{if(e.hostMaxWidth<Ve)return Q(ct);let t=Y[e.position]||Y.BOTTOM_RIGHT;return Q(t)},ht=(e,{position:t,hostMaxWidth:r})=>(e.style.cssText=dt+ut({position:t,hostMaxWidth:r}),e),pt=(e,t)=>({position:r})=>{let{host:i,container:o}=at(window,document)({id:lt});return ht(i,{position:r,hostMaxWidth:window.outerWidth}),it(t,i),{host:i,container:o}};function gt(e,t,r){return function(i){let{container:o,host:n}=pt(e,t)({position:i?.styles.position||"BOTTOM_RIGHT"});if(!o)throw new Error("Cannot mount app");return r?r({host:n,container:o},i):(console.warn("mountApp is not defined"),null)}}var mt=class{constructor(e,t){this.config=e,this.cacheManager=t,this.unmountWidgetApp=null,this.widgetApp=null,this.identifyUser=r=>{var i,o;return r.cohortUserId?(this.cohortUserId=r.cohortUserId,this.cohortProvider="AMPLITUDE",this.hasIdentifiedUser()&&(this.clearWidgetsForDomain(),(o=(i=this.config).onUserIdentified)==null||o.call(i,{cohortUserId:this.cohortUserId})),!0):!1},this.registerWidgetApp=r=>{this.widgetApp=r},this.deregisterWidgetApp=()=>{this.unMountApp(),this.widgetApp=null},this.renderWidget=(r,i,...o)=>v(this,[r,i,...o],function*(n,s,{forceRequest:a}={}){var d,c;let u={step:"start",hasUnmountWidgetAppCallback:!!this.unmountWidgetApp};try{l.verbose("[renderWidget] START",{url:this.url,forceRequest:a});let{shouldRender:p,widgetsForRoute:h,widgetsForDomain:m}=yield this.shouldRenderWidget({forceRequest:a,errorLogInfo:u});if(u.step="fetchedWidgets",u.hasWidgetsForDomain=!!m.length,u.hasWidgetsForRoute=!!h.length,u.widgetsForDomain=m.map(I=>I.uuid),u.widgetsForRoute=h.map(I=>I.uuid),u.shouldRender=p,l.verbose("[renderWidget] shouldRenderWidget",{shouldRender:p,widgetsForRoute:h,widgetsForDomain:m,widgetApp:this.widgetApp}),this.widgetApp||(u.step="registeringWidgetApp",yield(c=(d=this.config).onShouldRegisterWidgetApp)==null?void 0:c.call(d,{widgets:m,filteredWidgets:h})),u.step="registeredWidgetApp",u.registeredWidgetApp=!!this.widgetApp,!p){this.unMountApp();return}let[g]=h;if(this.unMountApp(),!this.widgetApp)return;let W=yield this.executeGetVariablesFromRouteLazy({url:this.url,paths:g.paths});u.routeVariables=W,u.step="renderingWidget",this.unmountWidgetApp=gt(n,s,this.widgetApp)(R(y({},g),{testingPagesUrl:this.config.testingPagesUrl,cohortUserId:this.cohortUserId,cohortProvider:this.cohortProvider,routeVariables:W,apiKey:this.config.apiKey}))}catch(p){let h=p,m={};throw h instanceof ne&&(m={statusCode:h.statusCode,correlationId:h.correlationId}),l.error("[renderWidget] error",{error:h}),this.mazeApi.logEvent({source:"contextualScaffold",level:"error",message:"Error while rendering widget",data:R(y({message:h.message,stack:h.stack,errorName:h.name},m),{errorLogInfo:u})}),h}}),this.setUrl=r=>{this.url=r},this.hasIdentifiedUser=()=>!!this.cohortUserId,this.clearWidgetsForDomain=()=>{this.widgetsForDomain=null},this.getWidgetsForDomain=()=>v(this,null,function*(){return l.verbose("[getWidgetsForDomain] START",{currentWidgetsForDomain:this.widgetsForDomain}),this.widgetsForDomain?(l.verbose("[getWidgetsForDomain] returned widgets from cache"),this.widgetsForDomain):(this.widgetsForDomain=yield this.mazeApi.getWidgetsForVisitor({cohortProvider:this.cohortProvider,cohortUserId:this.cohortUserId}),l.verbose("[getWidgetsForDomain] API result",{widgetsForDomain:this.widgetsForDomain}),this.widgetsForDomain)}),this.getWidgetsToRender=(...r)=>v(this,[...r],function*({forceRequest:i}={}){i&&this.clearWidgetsForDomain();let o=yield this.getWidgetsForDomain(),n=tt(),s=o?.filter(a=>!n.includes(a.uuid));return s??[]}),this.filterWidgetsForRoute=r=>v(this,null,function*(){let i=r.map(o=>v(this,null,function*(){let{paths:n=[]}=o;return n.length===0||(yield this.executePathMatchesPatternLazy({url:this.url,paths:n}))?o:null}));return(yield Promise.all(i)).filter(Boolean)}),this.shouldRenderWidget=(...r)=>v(this,[...r],function*({forceRequest:i,errorLogInfo:o}={}){let n=yield this.getWidgetsToRender({forceRequest:i});if(o&&(o.step="getWidgetsToRender"),l.verbose("[shouldRenderWidget] filteredWidgetsForDomain",{filteredWidgetsForDomain:n,forceRequest:i}),!n.length)return{shouldRender:!1,widgetsForRoute:n,widgetsForDomain:n};let s=yield this.filterWidgetsForRoute(n);return o&&(o.step="filterWidgetsForRoute"),{shouldRender:!!s.length,widgetsForRoute:s,widgetsForDomain:n}}),this.unMountApp=()=>{this.unmountWidgetApp&&(this.unmountWidgetApp(),this.unmountWidgetApp=null)},this.initHelpers=()=>v(this,null,function*(){var r,i;this.helpersLoadPromise&&(yield this.helpersLoadPromise),!this.helpers&&(this.helpersLoadPromise=(i=(r=this.config).onLoadWidgetHelper)==null?void 0:i.call(r),this.helpers=yield this.helpersLoadPromise,l.verbose("[initHelpers] helpers",{helpers:this.helpers}))}),this.cohortUserId=e.cohortUserId,this.cohortProvider=e.cohortProvider,this.url=e.url,this.mazeApi=se({apiUrl:e.apiUrl,apiKey:e.apiKey})}get widgetsForDomain(){return this.cacheManager.getValue("maze:widgets")}set widgetsForDomain(e){try{this.cacheManager.setValue("maze:widgets",e,15),l.verbose("[set widgetsForDomain] cached widgets",{value:e})}catch(t){this.cacheManager=new F,this.cacheManager.setValue("maze:widgets",e),l.error("[set widgetsForDomain] error while saving to cache (using fallback)",{error:t,value:e}),this.mazeApi.logEvent({source:"contextualScaffold",level:"warn",message:"Failed to save widgets to session storage. Using fallback.",data:{message:t.message,value:e}})}}executeGetVariablesFromRouteLazy(e){return v(this,arguments,function*({url:t,paths:r}){var i;return this.helpers||(yield this.initHelpers()),(i=this.helpers)!=null&&i.getVariablesFromRoute?this.helpers.getVariablesFromRoute({url:t,paths:r}):(l.error("[executeGetVariablesFromRouteLazy] helpers not initialized"),{})})}executePathMatchesPatternLazy(e){return v(this,arguments,function*({url:t,paths:r}){var i;return this.helpers||(yield this.initHelpers()),(i=this.helpers)!=null&&i.pathMatchesPattern?this.helpers.pathMatchesPattern({url:t,paths:r}):(l.error("[executePathMatchesPatternLazy] helpers not initialized"),!1)})}},vt=(e,t)=>{let r=_e(e),i=y(y({},r),t||{}),{userId:o}=te(e);return!i.cohortUserId&&o&&(i.cohortUserId=o,i.cohortProvider="AMPLITUDE"),i};function ft(e,t){let r=je(e),i=typeof e<"u"&&e.sessionStorage?new re(e.sessionStorage):new F;P.initializeLoggerMode(e);let o=window.location.href;return l.verbose("[createContextualWidget] START"),function(n){let s=vt(e,n),a=Me(e),d=se({apiUrl:s.apiUrl,apiKey:s.apiKey}),c=!1,u=f=>{g.setUrl(f),g.renderWidget(e,t).catch(w=>{l.error("[handleRouteChange] renderWidget",{error:w})})},p=({widgets:f,filteredWidgets:w})=>new Promise((E,U)=>{if(l.verbose("[onShouldRegisterWidgetApp] START",{attachedRouteChangeListener:c,widgetsForDomain:f,widgetsForPath:w}),f!=null&&f.length&&!c){c=!0;let pe=Be(e,t);e.addEventListener("hashchange",A=>{l.verbose("[onShouldRegisterWidgetApp] hashChange event",{url:A.newURL}),u(A.newURL)}),pe(A=>{l.verbose("[onShouldRegisterWidgetApp] onRouteChange",{url:A}),u(A)})}if(!w||w.length===0){E(!1);return}l.verbose("[onShouldRegisterWidgetApp] loadWidgetAppScript",{snippetCdnUrl:s.snippetCdnUrl});let M=Ze(t,e,{snippetCdnUrl:s.snippetCdnUrl});M.onload=()=>{l.verbose("[onShouldRegisterWidgetApp] loadWidgetAppScript onLoad event"),E(!0)},M.onerror=()=>{U(new ie("Error loading widget app script"))}}),h=()=>v(this,null,function*(){return l.verbose("[onLoadWidgetHelper] load helper script",{snippetCdnUrl:s.snippetCdnUrl}),yield ke(t,e,{snippetCdnUrl:s.snippetCdnUrl}),e.mazeHelpers});r.listen(({type:f,payload:w})=>{if(f==="registerWidgetApp"){l.verbose("[onWidgetEvent] registerWidgetApp",{type:f}),g.renderWidget(e,t).catch(E=>{l.error("[onWidgetEvent] renderWidget",{type:f,error:E})});return}f==="deregisterWidgetApp"&&(l.verbose("[onWidgetEvent] deregisterWidgetApp",{type:f}),g.deregisterWidgetApp()),f==="widgetAppError"&&(l.error("[widgetAppError]",y({},w)),d.logEvent({source:"widgetApp",level:"error",message:"Error in widget React app",data:w}))});let m=()=>v(this,null,function*(){yield g.renderWidget(e,t)}),g=new mt(R(y({},s),{communicate:r,onShouldRegisterWidgetApp:p,onLoadWidgetHelper:h,onUserIdentified:m,url:o}),i);a(g);let W=!1,I=0,x=setInterval(()=>{if(I+=1,W){l.verbose("[detection] widget already loaded",{siteLoaded:W,activationAttempt:I}),clearInterval(x);return}if(I>10){l.warning("[detection] max activation attempt triggered",{activationAttempt:I,siteLoaded:W}),clearInterval(x);return}(t.readyState==="complete"||t.readyState==="interactive")&&(l.verbose("[detection] readyState triggered",{siteLoaded:W,activationAttempt:I}),clearInterval(x),W=!0,g.renderWidget(e,t))},1e3);e.addEventListener("load",()=>v(this,null,function*(){l.verbose("[window] onLoad",{siteLoaded:W}),clearInterval(x),W=!0,yield g.renderWidget(e,t)}));let he=({forceRequest:f=!1,forRoute:w}={})=>{if(l.verbose("[render] START",{forceRequest:f,forRoute:w}),w){let E=new URL(e.location.href).origin;try{let U=new URL(E+w);l.verbose("[render] set new URL",{newUrl:U}),g.setUrl(U.href)}catch(U){l.error("[render] Invalid URL",{baseUrl:E,forRoute:w,error:U});return}}g.renderWidget(e,t,{forceRequest:f})};return R(y({},g),{render:he})}}});var Ee=(e,t)=>e&&t?`${e}/static/${t}`:"",Ue="1f0c9afcc54aead5eef198ad67e241b9ee5c1fde",$=Ee("https://snippet.maze.co",Ue);var H="https://prompts.maze.co/api",j="https://t.maze.co";var ce=Ie(de());var ue=(e,t)=>{let r=(e==null?void 0:e.mazeUniversalSnippetApiKey)||"",i=b({},(e==null?void 0:e.mazePromptsSettings)||{apiKey:r});return(o={})=>{!i.apiKey&&r&&(i.apiKey=r),e.mazePrompts=(0,ce.createContextualWidget)(e,t)(b(b({},i),o))}};var wt={apiUrl:H,testingPagesUrl:j,snippetCdnUrl:$};ue(window,document)(wt);})();
